<div class="blade-content __xxlarge-wide">
  <div class="blade-inner">
    <div class="inner-block">
      <div ng-if="blade.data && blade.data.settingScopes.length || !blade.allEnvironmentsWithoutError()" class="comparison-header">
        <div class="comparison-filters blade-static">
          <div class="form-group">
            <vc-environments-compare-search blade="blade"></vc-environments-compare-search>
          </div>
        </div>
      </div>
      <div ng-if="blade.data && blade.data.settingScopes.length || !blade.allEnvironmentsWithoutError()" class="comparison-container">
        <table class="comparison-list" ng-style="{'width': blade.totalWidth + 'px'}">
          <colgroup>
            <col ng-style="{'width': blade.markerColWidth + 'px'}" />
            <col ng-style="{'width': blade.nameColWidth + 'px'}" />
            <col ng-repeat="(index, environment) in blade.data.comparedEnvironments" ng-style="{'width': blade.valueColWidth + 'px'}" />
          </colgroup>
          <thead>
            <tr class="comparison-list-header">
              <th class="sticky-col"></th>
              <th class="comparison-settings-name">
                {{ 'environments-compare.blades.environments-comparison.labels.setting-name' | translate }}
              </th>
              <th ng-repeat="(index, environment) in blade.data.comparedEnvironments"
                  ng-class="{
                    'environment-error': environment.errorMessage,
                    'environment-name-clickable': !environment.isComparisonBase && !environment.errorMessage
                  }"
                  ng-click="!environment.errorMessage && blade.setBaseEnvironment(environment)">
                <span class="env-header-inner">
                  <span ng-if="!environment.isComparisonBase && !environment.errorMessage" class="fas fa-microscope"></span>
                  <span ng-if="environment.isComparisonBase" class="fas fa-star"></span>
                  <span class="env-name">{{ environment.environmentName }}</span>
                  <span ng-if="environment.errorMessage" class="fas fa-exclamation-triangle" title="{{ environment.errorMessage }}"></span>
                </span>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr class="comparison-environments-summary">
              <td class="sticky-col"></td>
              <td class="comparison-environments-summary-title">{{ 'environments-compare.blades.environments-comparison.labels.environment-summary' | translate }}</td>
              <td ng-repeat="(index, environment) in blade.data.comparedEnvironments" ng-class="{'environment-error': environment.errorMessage }">{{ environment.errorMessage }}</td>
            </tr>

            <tr ng-if="0" ng-repeat-start="(scopeIndex, settingScope) in blade.data.settingScopes" />

            <tr class="comparison-settings-scope-header"
                ng-if="!blade.hideEmptySections || blade.scopeHasVisibleSettings(settingScope)">
              <td class="scope-marker-{{scopeIndex}} sticky-col"></td>
              <td class="comparison-settings-scope-name">{{ settingScope.scopeName }}</td>
              <td ng-repeat="(environmentIndex, environment) in blade.data.comparedEnvironments" ng-class="{'environment-error': environment.errorMessage }"></td>
            </tr>

            <tr ng-if="0" ng-repeat-start="(groupIndex, settingGroup) in settingScope.settingGroups" />

            <tr class="comparison-settings-group-header"
                ng-if="!blade.hideEmptySections || blade.groupHasVisibleSettings(settingGroup)">
              <td class="scope-marker-{{scopeIndex}} sticky-col"></td>
              <td class="comparison-settings-group-name">{{ settingGroup.groupName }}</td>
              <td ng-repeat="(environmentIndex, environment) in blade.data.comparedEnvironments" ng-class="{'environment-error': environment.errorMessage }"></td>
            </tr>

            <tr ng-if="0" ng-repeat-start="(settingIndex, setting) in settingGroup.settings | filter: blade.filterByText" />
            <tr ng-class="{'comparison-diff': blade.anyEnvironmentComparedValueHasDiff(setting) }">
              <td class="scope-marker-{{scopeIndex}} sticky-col"></td>
              <td class="comparison-settings-name">
                <div class="comparison-settings-name-inner">
                  <span class="comparison-settings-name-text">{{ setting.name }}</span>
                  <a href=""
                     ng-if="setting.descriptionText"
                     class="comparison-settings-description-toggle"
                     ng-click="$event.preventDefault(); setting.showDescription = !setting.showDescription">
                    <i class="form-ico fa fa-question-circle __link __lightblue"></i>
                  </a>
                </div>
                <div class="comparison-settings-description" ng-if="setting.showDescription">
                  {{ setting.descriptionText }}
                </div>
              </td>
              <td ng-repeat="(environmentIndex, environment) in blade.data.comparedEnvironments" ng-class="{'comparison-diff': !environment.errorMessage && blade.environmentComparedValueHasDiff(setting, environment.environmentName), 'environment-error': environment.errorMessage }">{{ blade.getComparedValueOrError(setting,  environment.environmentName) }}</td>
            </tr>

            <tr ng-if="0" ng-repeat-end />

            <tr ng-if="0" ng-repeat-end />

            <tr ng-if="0" ng-repeat-end />

          </tbody>
        </table>
      </div> 
      <div ng-if="blade.data && !blade.data.settingScopes.length && blade.allEnvironmentsWithoutError()" class="comparison-no-data">
        <div class="comparison-no-data-inner">
          <i class="fas fa-check-circle comparison-no-data-icon"></i>
          <div class="comparison-no-data-title">
            {{ 'environments-compare.blades.environments-comparison.labels.no-differences-title' | translate }}
          </div>
          <div class="comparison-no-data-text">
            {{ 'environments-compare.blades.environments-comparison.labels.no-differences-text' | translate }}
          </div>
          <button class="btn __secondary" ng-click="blade.showAllSettings()" ng-if="!blade.showAll">
            {{ 'environments-compare.blades.environments-comparison.toolbar.show-all' | translate }}
          </button>
        </div>
      </div>
    </div>
  </div>
</div>